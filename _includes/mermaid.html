<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        mermaid.initialize({ 
            startOnLoad: false,
            theme: 'dark',
            securityLevel: 'loose',
            themeVariables: {
                primaryColor: '#1a3a4a',
                primaryTextColor: '#ffffff',
                primaryBorderColor: '#2d4a3d',
                lineColor: '#ffffff',
                arrowheadColor: '#ffffff'
            }
        });
        
        // Convert fenced code blocks to mermaid divs
        document.querySelectorAll('pre code.language-mermaid').forEach((block, index) => {
            const content = block.textContent;
            const wrapper = document.createElement('div');
            wrapper.className = 'mermaid';
            wrapper.id = 'mermaid-' + index;
            wrapper.textContent = content;
            block.parentElement.parentNode.replaceChild(wrapper, block.parentElement);
        });
        
        mermaid.run();
    });
</script>